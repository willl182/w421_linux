# Problem Record (Troubleshooting)

**Severity**: Medium

## The Problem

`sshd -T` seguia mostrando `passwordauthentication yes` despues de aplicar hardening y recargar SSH.

Esto daba una falsa sensacion de cierre de riesgo si solo se revisaba el archivo `99-hardening.conf`.

## The Solution / Workaround

1. Auditar todas las ocurrencias de `PasswordAuthentication` en `sshd_config` y `sshd_config.d`.
2. Identificar conflicto con `50-cloud-init.conf`.
3. Deshabilitar archivo conflictivo y volver a validar con `sshd -t` + `sshd -T`.
4. Fijar persistencia con `ssh_pwauth: false` en cloud-init.

## Learnings to Preserve

- Nunca asumir que un archivo `.d/99-*.conf` siempre prevalece en este entorno.
- Validar estado efectivo con `sshd -T`, no solo por inspeccion de archivos.
- Cerrar exposure de SSH con UFW por IP especifica reduce superficie de ataque incluso con puerto 22.
